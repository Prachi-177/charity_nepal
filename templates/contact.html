{% extends "base.html" %}
{% block title %}Contact Us — CharityNepal{% endblock %}

{% block extra_head %}
<!-- Tailwind CSS CDN -->
<script src="https://cdn.tailwindcss.com"></script>
<!-- Vue.js 3 CDN -->
<script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
<!-- Font Awesome -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
    [v-cloak] {
        display: none;
    }
</style>
{% endblock %}

{% block content %}
<div id="contactApp" v-cloak class="bg-gradient-to-br from-green-50 via-white to-blue-50 min-h-screen py-24 sm:py-32">
    <div class="mx-auto max-w-7xl px-6 lg:px-8">
        <!-- Header Section -->
        <div class="mx-auto max-w-2xl text-center mb-16">
            <h2 class="text-4xl font-black tracking-tight text-gray-900 sm:text-5xl mb-4">
                <i class="fas fa-envelope text-green-600 mr-3"></i>
                Contact Us
            </h2>
            <p class="mt-6 text-lg leading-8 text-gray-600">
                We'd love to hear from you. Whether you have a question about our platform, 
                a specific campaign, or just want to say hello, please don't hesitate to reach out.
            </p>
        </div>

        <!-- Success Message -->
        <transition
            enter-active-class="transition ease-out duration-300"
            enter-from-class="opacity-0 transform scale-95"
            enter-to-class="opacity-100 transform scale-100"
            leave-active-class="transition ease-in duration-200"
            leave-from-class="opacity-100 transform scale-100"
            leave-to-class="opacity-0 transform scale-95"
        >
            <div v-if="showSuccess" class="mx-auto max-w-xl mb-8">
                <div class="bg-green-50 border-l-4 border-green-500 rounded-lg p-6 shadow-lg">
                    <div class="flex items-start">
                        <div class="flex-shrink-0">
                            <i class="fas fa-check-circle text-green-500 text-3xl"></i>
                        </div>
                        <div class="ml-4">
                            <h3 class="text-lg font-bold text-green-800 mb-2">
                                ✅ Message Sent Successfully!
                            </h3>
                            <p class="text-green-700">
                                Thank you for reaching out! We've received your message and will get back to you soon.
                            </p>
                        </div>
                        <button @click="showSuccess = false" class="ml-auto flex-shrink-0 text-green-500 hover:text-green-700">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                </div>
            </div>
        </transition>

        <!-- Contact Form -->
        <div class="mx-auto mt-16 max-w-xl sm:mt-20">
            <form @submit.prevent="submitForm" class="bg-white/80 backdrop-blur-lg rounded-3xl shadow-2xl border border-white/20 p-8">
                <!-- Name Field -->
                <div class="mb-6">
                    <label for="name" class="block text-sm font-bold leading-6 text-gray-900 mb-2">
                        <i class="fas fa-user text-green-600 mr-2"></i>
                        Name
                    </label>
                    <input 
                        type="text" 
                        v-model="formData.name" 
                        id="name" 
                        required
                        :class="{'ring-red-500': errors.name}"
                        class="block w-full rounded-xl border-0 px-4 py-3 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-green-600 sm:text-sm transition-all duration-200"
                        placeholder="Enter your full name"
                    >
                    <p v-if="errors.name" class="mt-2 text-sm text-red-600">
                        <i class="fas fa-exclamation-circle mr-1"></i>
                        [[ errors.name ]]
                    </p>
                </div>

                <!-- Email Field -->
                <div class="mb-6">
                    <label for="email" class="block text-sm font-bold leading-6 text-gray-900 mb-2">
                        <i class="fas fa-envelope text-green-600 mr-2"></i>
                        Email
                    </label>
                    <input 
                        type="email" 
                        v-model="formData.email" 
                        id="email" 
                        required
                        :class="{'ring-red-500': errors.email}"
                        class="block w-full rounded-xl border-0 px-4 py-3 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-green-600 sm:text-sm transition-all duration-200"
                        placeholder="your.email@example.com"
                    >
                    <p v-if="errors.email" class="mt-2 text-sm text-red-600">
                        <i class="fas fa-exclamation-circle mr-1"></i>
                        [[ errors.email ]]
                    </p>
                </div>

                <!-- Message Field -->
                <div class="mb-6">
                    <label for="message" class="block text-sm font-bold leading-6 text-gray-900 mb-2">
                        <i class="fas fa-comment-dots text-green-600 mr-2"></i>
                        Message
                    </label>
                    <textarea 
                        v-model="formData.message" 
                        id="message" 
                        rows="5" 
                        required
                        :class="{'ring-red-500': errors.message}"
                        class="block w-full rounded-xl border-0 px-4 py-3 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-green-600 sm:text-sm transition-all duration-200 resize-none"
                        placeholder="Tell us how we can help you..."
                    ></textarea>
                    <p v-if="errors.message" class="mt-2 text-sm text-red-600">
                        <i class="fas fa-exclamation-circle mr-1"></i>
                        [[ errors.message ]]
                    </p>
                    <p class="mt-2 text-sm text-gray-500">
                        [[ formData.message.length ]] / 500 characters
                    </p>
                </div>

                <!-- Submit Button -->
                <div class="mt-8">
                    <button 
                        type="submit" 
                        :disabled="isSubmitting"
                        class="block w-full rounded-xl bg-gradient-to-r from-green-600 to-green-500 px-6 py-4 text-center text-base font-bold text-white shadow-lg hover:from-green-700 hover:to-green-600 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-green-600 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 transform hover:scale-105"
                    >
                        <span v-if="!isSubmitting">
                            <i class="fas fa-paper-plane mr-2"></i>
                            Submit
                        </span>
                        <span v-else>
                            <i class="fas fa-spinner fa-spin mr-2"></i>
                            Sending...
                        </span>
                    </button>
                </div>
            </form>

            <!-- Contact Info Cards -->
            <div class="mt-12 grid grid-cols-1 gap-6 sm:grid-cols-2">
                <!-- Email Card -->
                <div class="bg-white/80 backdrop-blur-lg rounded-2xl shadow-xl border border-white/20 p-6 text-center hover:shadow-2xl transition-all duration-200 transform hover:scale-105">
                    <div class="inline-flex items-center justify-center w-16 h-16 bg-green-100 rounded-full mb-4">
                        <i class="fas fa-envelope text-green-600 text-2xl"></i>
                    </div>
                    <h3 class="text-lg font-bold text-gray-900 mb-2">Email Us</h3>
                    <p class="text-gray-600 text-sm">support@charitynepal.org</p>
                </div>

                <!-- Phone Card -->
                <div class="bg-white/80 backdrop-blur-lg rounded-2xl shadow-xl border border-white/20 p-6 text-center hover:shadow-2xl transition-all duration-200 transform hover:scale-105">
                    <div class="inline-flex items-center justify-center w-16 h-16 bg-blue-100 rounded-full mb-4">
                        <i class="fas fa-phone text-blue-600 text-2xl"></i>
                    </div>
                    <h3 class="text-lg font-bold text-gray-900 mb-2">Call Us</h3>
                    <p class="text-gray-600 text-sm">+977 123 456 7890</p>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    const { createApp } = Vue;

    createApp({
        delimiters: ['[[', ']]'],
        data() {
            return {
                formData: {
                    name: '',
                    email: '',
                    message: ''
                },
                errors: {
                    name: '',
                    email: '',
                    message: ''
                },
                showSuccess: false,
                isSubmitting: false
            };
        },
        methods: {
            validateForm() {
                this.errors = {
                    name: '',
                    email: '',
                    message: ''
                };

                let isValid = true;

                // Validate name
                if (!this.formData.name.trim()) {
                    this.errors.name = 'Name is required';
                    isValid = false;
                } else if (this.formData.name.trim().length < 2) {
                    this.errors.name = 'Name must be at least 2 characters';
                    isValid = false;
                }

                // Validate email
                if (!this.formData.email.trim()) {
                    this.errors.email = 'Email is required';
                    isValid = false;
                } else if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(this.formData.email)) {
                    this.errors.email = 'Please enter a valid email address';
                    isValid = false;
                }

                // Validate message
                if (!this.formData.message.trim()) {
                    this.errors.message = 'Message is required';
                    isValid = false;
                } else if (this.formData.message.trim().length < 10) {
                    this.errors.message = 'Message must be at least 10 characters';
                    isValid = false;
                } else if (this.formData.message.length > 500) {
                    this.errors.message = 'Message must not exceed 500 characters';
                    isValid = false;
                }

                return isValid;
            },
            async submitForm() {
                if (!this.validateForm()) {
                    return;
                }

                this.isSubmitting = true;

                // Simulate API call (replace with actual backend endpoint if needed)
                await new Promise(resolve => setTimeout(resolve, 1500));

                // Log the form data (in production, send to backend)
                console.log('Form submitted:', this.formData);

                // Show success message
                this.showSuccess = true;

                // Reset form
                this.formData = {
                    name: '',
                    email: '',
                    message: ''
                };

                this.isSubmitting = false;

                // Auto-hide success message after 5 seconds
                setTimeout(() => {
                    this.showSuccess = false;
                }, 5000);

                // Scroll to top to show success message
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }
    }).mount('#contactApp');
</script>
{% endblock %}
